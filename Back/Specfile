spec('1.2.0') do

  # Struct spec version https://github.com/lyptt/struct/wiki/Specfile-format:-v1.2.0

  #=== GLOBAL SETTINGS ===

  iOSDeploymentTarget = '8.0'
  CompanyIdentifier = 'khatskevich.maxim'
  ProjectTitle = 'MKHRequirement'
  DevelopmentTeamId = 'UJA88X59XP' # 'Maxim Khatskevich'

  cfgDebug = 'Debug'
  cfgRelease = 'Release'

  #=== SHARED SETTINGS - ALL targets, ALL configurations ===

  def commonSettings

    #--- PROJECT-related settings

    override 'DEVELOPMENT_TEAM', DevelopmentTeamId
    

    #--- OTHER settings

    override 'SDKROOT', 'iphoneos'
    override 'TARGETED_DEVICE_FAMILY', '1,2'
    override 'SWIFT_VERSION', '3.0'
    override 'VERSIONING_SYSTEM', 'apple-generic'

  end # CommonSettings

  #=== SHARED SETTINGS - Fwk target ONLY, ALL configurations ===

  def fwkSettings

    override 'INFOPLIST_FILE', 'Info/MAXX.plist'

    #--- PROJECT-related settings

    override 'PRODUCT_BUNDLE_IDENTIFIER', CompanyIdentifier + '.' + ProjectTitle
    override 'PRODUCT_NAME', ProjectTitle
    # override 'INFOPLIST_FILE', 'Info/' + ProjectTitle + '.plist'
    
    #--- OTHER settings

    override 'DEFINES_MODULE', 'NO'
    override 'SKIP_INSTALL', 'YES'

  end # FwkSettings

  #=== SHARED SETTINGS - Unit tests target ONLY, ALL configurations ===

  def tstFwkSettings

    #--- PROJECT-related settings

    override 'PRODUCT_BUNDLE_IDENTIFIER', CompanyIdentifier + '.' + ProjectTitle + 'Tst'
    override 'PRODUCT_NAME', ProjectTitle + 'Tst'
    override 'INFOPLIST_FILE', 'Info/' + ProjectTitle + 'Tst.plist'
    override 'FRAMEWORK_SEARCH_PATHS', '$(inherited) $(BUILT_PRODUCTS_DIR)'
    
    #--- OTHER settings

    # override 'TEST_HOST', '$(BUILT_PRODUCTS_DIR)/iOSTest.app/iOSTest' # ???
    
  end # TstFwkSettings

  #=== SPEC ===

  configuration(cfgDebug) do

    type :debug

    profile 'general:debug'
    profile 'ios:debug'

    commonSettings

    override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget

  end # configuration(cfgDebug)

  #===

  configuration(cfgRelease) do

    type :release

    profile 'general:release'
    profile 'ios:release'

    commonSettings

    override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget

  end # configuration(cfgRelease)

  #===

  target(ProjectTitle) do

    platform 'ios'
    type ':framework'

    source_dir 'Src'

    profile 'platform:ios'
    profile 'framework'

    # system_reference 'Foundation.framework'

    #===

    configuration(cfgDebug) do

      fwkSettings

      override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget
      override 'SWIFT_OPTIMIZATION_LEVEL', '-Onone'

    end # configuration(cfgDebug)

    #===

    configuration(cfgRelease) do

      fwkSettings

      override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget

    end # configuration(cfgRelease)

    #===

    # script 'scripts/sample.sh'

  end # target(ProjectTitle)

  #===

  target('Tests') do

    # platform 'ios' # ???
    type ':bundle.unit-test'

    target_reference ProjectTitle # override 'TEST_HOST'/'TEST_TARGET_NAME'???

    source_dir 'Tst'

    profile 'platform:ios'
    profile 'bundle.unit-test'

    #===

    configuration(cfgDebug) do

      tstFwkSettings

      override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget
      override 'SWIFT_OPTIMIZATION_LEVEL', '-Onone'

    end # configuration(cfgDebug)

    #===

    configuration(cfgRelease) do

      tstFwkSettings

      override 'IPHONEOS_DEPLOYMENT_TARGET', iOSDeploymentTarget

    end # configuration(cfgRelease)

  end # target('Tst')

  #===

  variant('$base') do

    abstract

  end # variant('$base') 

  #===

  variant('Main') do

    #

  end # variant(ProjectTitle)

end